<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Facebook Poster</title>
</head>

<body>
  <h1>Aplicación desarrollada en Typescript para publicar automáticamente a Facebook</h1>
  <button id="run-worker">Presióname para publicar!!!</button>
  <p id="status"></p>

  <script>
    const btn = document.getElementById('run-worker');
    const status = document.getElementById('status');

    btn.addEventListener('click', async () => {
      status.textContent = 'Iniciando proceso...';
      status.style.color = 'black'; // color neutral mientras se procesa
      try {
        const res = await fetch('/run-worker', { method: 'POST' });
        const data = await res.json();

        // Cambiar color según el status
        if (data.status === "OK") {
          status.style.color = 'green';
        } else if (data.status === "ERROR" || data.status === "empty") {
          status.style.color = 'red';
        } else {
          status.style.color = 'orange';
        }

        // Mostrar mensaje
        status.textContent = data.message;

      } catch (err) {
        status.textContent = 'Error de conexión ❌';
        status.style.color = 'red';
        console.error(err);
      }
    });
  </script>


</body>

</html>